<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>캐릭터 조회 & 추적</title>
    <style>
        body { font-family: Arial, sans-serif; }
        
        /* 전체 레이아웃 설정 */
        .container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            max-width: 1200px;
            margin: auto;
            gap: 20px;
        }

        /* 왼쪽 캐릭터 조회 영역 */
        .search-section {
            width: 45%;
        }

        /* 오른쪽 예의주시 목록 */
        .tracking-section {
            width: 50%;
        }

        /* 캐릭터 카드 스타일 */
        .character-card {
            border: 1px solid #ccc; 
            padding: 10px; 
            margin: 5px; 
            border-radius: 5px;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            width: 100%;
        }

        .character-list {
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
            margin-top: 10px;
        }

        .option-group { margin-top: 5px; }
        .result { margin-top: 10px; font-size: 14px; }
        button { margin-top: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h2>캐릭터 조회 & 추적</h2>

    <div class="container">
        <!-- 왼쪽: 캐릭터 검색 -->
        <div class="search-section">
            <h3>캐릭터 조회</h3>
            <input type="text" id="characterName" placeholder="캐릭터명 입력">
            <button onclick="fetchOCID()">조회</button>
            <div id="result"></div>
        </div>

        <!-- 오른쪽: 예의주시하는 캐릭터 -->
        <div class="tracking-section">
            <h3>예의주시하는 캐릭터</h3>
            <input type="text" id="trackingCharacterName" placeholder="캐릭터명 입력">
            <button onclick="addCharacter()">등록</button>
            <div class="character-list" id="characterList"></div>
        </div>
    </div>

    <script>
        const apiKey = "test_f1df2d99b1e14e205493879cae9b176db3420a00c4bfddb543475cd58d231840efe8d04e6d233bd35cf2fabdeb93fb0d";
        const servers = ["연", "해명", "세류", "무휼"];
        let trackingIntervals = {};

        function fetchOCID() {
            const characterName = document.getElementById("characterName").value.trim();
            if (!characterName) {
                alert("캐릭터명을 입력하세요.");
                return;
            }
            document.getElementById("result").innerText = `🔍 ${characterName} 검색 중...`;
            setTimeout(() => {
                document.getElementById("result").innerHTML = `
                    <strong>닉네임:</strong> ${characterName}<br>
                    <strong>레벨:</strong> 99<br>
                    <strong>서버:</strong> 연<br>
                    <strong>경험치:</strong> 123,456,789 EXP
                `;
            }, 1000); // 실제 API 연결 시 이 부분을 수정
        }

        function addCharacter() {
            const characterName = document.getElementById("trackingCharacterName").value.trim();
            if (!characterName) {
                alert("캐릭터명을 입력하세요.");
                return;
            }

            const cardId = `char-${characterName}`;
            if (document.getElementById(cardId)) {
                alert("이미 등록된 캐릭터입니다.");
                return;
            }

            const characterCard = document.createElement("div");
            characterCard.className = "character-card";
            characterCard.id = cardId;
            characterCard.innerHTML = `
                <strong>${characterName}</strong>
                <div class="option-group">
                    <label><input type="radio" name="interval-${cardId}" value="10000"> 10초</label>
                    <label><input type="radio" name="interval-${cardId}" value="30000"> 30초</label>
                    <label><input type="radio" name="interval-${cardId}" value="60000"> 1분</label>
                    <label><input type="radio" name="interval-${cardId}" value="300000"> 5분</label>
                    <label><input type="radio" name="interval-${cardId}" value="600000"> 10분</label>
                </div>
                <button onclick="startTracking('${characterName}', '${cardId}')">추적하기</button>
                <button onclick="stopTracking('${characterName}', '${cardId}')">중지</button>
                <button onclick="removeCharacter('${cardId}')">제거</button>
                <div class="result" id="result-${cardId}">결과 대기 중...</div>
            `;
            document.getElementById("characterList").appendChild(characterCard);
        }

        function removeCharacter(cardId) {
            stopTracking(null, cardId);
            document.getElementById(cardId)?.remove();
        }

        function startTracking(characterName, cardId) {
            stopTracking(characterName, cardId);
            const selectedInterval = document.querySelector(`input[name="interval-${cardId}"]:checked`);
            if (!selectedInterval) {
                alert("조회 주기를 선택하세요.");
                return;
            }
            const intervalTime = parseInt(selectedInterval.value, 10);
            trackingIntervals[cardId] = setInterval(() => fetchCharacterData(characterName, cardId), intervalTime);
            fetchCharacterData(characterName, cardId);
            alert(`${characterName}의 정보를 ${intervalTime / 1000}초마다 조회합니다.`);
        }

        function stopTracking(characterName, cardId) {
            if (trackingIntervals[cardId]) {
                clearInterval(trackingIntervals[cardId]);
                delete trackingIntervals[cardId];
                if (characterName) alert(`${characterName}의 자동 조회를 중지했습니다.`);
            }
        }

        function fetchCharacterData(characterName, cardId) {
            document.getElementById(`result-${cardId}`).innerText = `🔄 ${characterName} 정보 갱신 중...`;
            setTimeout(() => {
                document.getElementById(`result-${cardId}`).innerHTML = `
                    <strong>레벨:</strong> 99<br>
                    <strong>서버:</strong> 연<br>
                    <strong>경험치:</strong> 123,456,789 EXP
                `;
            }, 1000);
        }
    </script>
</body>
</html>
